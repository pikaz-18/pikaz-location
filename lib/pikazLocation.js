!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.pikazLocation=o():t.pikazLocation=o()}(self,(function(){return t={961:(t,o,e)=>{var n,i=function(){var t=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function i(t,o){if(!n[t]){n[t]={};for(var e=0;e<t.length;e++)n[t][t.charAt(e)]=e}return n[t][o]}var r={compressToBase64:function(t){if(null==t)return"";var e=r._compress(t,6,(function(t){return o.charAt(t)}));switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:r._decompress(t.length,32,(function(e){return i(o,t.charAt(e))}))},compressToUTF16:function(o){return null==o?"":r._compress(o,15,(function(o){return t(o+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:r._decompress(t.length,16384,(function(o){return t.charCodeAt(o)-32}))},compressToUint8Array:function(t){for(var o=r.compress(t),e=new Uint8Array(2*o.length),n=0,i=o.length;n<i;n++){var c=o.charCodeAt(n);e[2*n]=c>>>8,e[2*n+1]=c%256}return e},decompressFromUint8Array:function(o){if(null==o)return r.decompress(o);for(var e=new Array(o.length/2),n=0,i=e.length;n<i;n++)e[n]=256*o[2*n]+o[2*n+1];var c=[];return e.forEach((function(o){c.push(t(o))})),r.decompress(c.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":r._compress(t,6,(function(t){return e.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),r._decompress(t.length,32,(function(o){return i(e,t.charAt(o))})))},compress:function(o){return r._compress(o,16,(function(o){return t(o)}))},_compress:function(t,o,e){if(null==t)return"";var n,i,r,c={},a={},s="",l="",u="",p=2,d=3,h=2,f=[],m=0,g=0;for(r=0;r<t.length;r+=1)if(s=t.charAt(r),Object.prototype.hasOwnProperty.call(c,s)||(c[s]=d++,a[s]=!0),l=u+s,Object.prototype.hasOwnProperty.call(c,l))u=l;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(n=0;n<h;n++)m<<=1,g==o-1?(g=0,f.push(e(m)),m=0):g++;for(i=u.charCodeAt(0),n=0;n<8;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)m=m<<1|i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete a[u]}else for(i=c[u],n=0;n<h;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1;0==--p&&(p=Math.pow(2,h),h++),c[l]=d++,u=String(s)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(n=0;n<h;n++)m<<=1,g==o-1?(g=0,f.push(e(m)),m=0):g++;for(i=u.charCodeAt(0),n=0;n<8;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)m=m<<1|i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete a[u]}else for(i=c[u],n=0;n<h;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1;0==--p&&(p=Math.pow(2,h),h++)}for(i=2,n=0;n<h;n++)m=m<<1|1&i,g==o-1?(g=0,f.push(e(m)),m=0):g++,i>>=1;for(;;){if(m<<=1,g==o-1){f.push(e(m));break}g++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:r._decompress(t.length,32768,(function(o){return t.charCodeAt(o)}))},_decompress:function(o,e,n){var i,r,c,a,s,l,u,p=[],d=4,h=4,f=3,m="",g=[],y={val:n(0),position:e,index:1};for(i=0;i<3;i+=1)p[i]=i;for(c=0,s=Math.pow(2,2),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;switch(c){case 0:for(c=0,s=Math.pow(2,8),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;u=t(c);break;case 1:for(c=0,s=Math.pow(2,16),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;u=t(c);break;case 2:return""}for(p[3]=u,r=u,g.push(u);;){if(y.index>o)return"";for(c=0,s=Math.pow(2,f),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;switch(u=c){case 0:for(c=0,s=Math.pow(2,8),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;p[h++]=t(c),u=h-1,d--;break;case 1:for(c=0,s=Math.pow(2,16),l=1;l!=s;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=e,y.val=n(y.index++)),c|=(a>0?1:0)*l,l<<=1;p[h++]=t(c),u=h-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,f),f++),p[u])m=p[u];else{if(u!==h)return null;m=r+r.charAt(0)}g.push(m),p[h++]=r+m.charAt(0),r=m,0==--d&&(d=Math.pow(2,f),f++)}}};return r}();void 0===(n=function(){return i}.call(o,e,o,t))||(t.exports=n)},895:t=>{t.exports=function(t,o,e,n){var i=t[0],r=t[1],c=!1;void 0===e&&(e=0),void 0===n&&(n=o.length);for(var a=(n-e)/2,s=0,l=a-1;s<a;l=s++){var u=o[e+2*s+0],p=o[e+2*s+1],d=o[e+2*l+0],h=o[e+2*l+1];p>r!=h>r&&i<(d-u)*(r-p)/(h-p)+u&&(c=!c)}return c}},138:(t,o,e)=>{const n=e(895),{decompressFromEncodedURIComponent:i}=e(961),r={timeout:3e3,enableHighAccuracy:!1,url:"https://unpkg.com/@pikaz/location/lib"},c={province:"",city:"",district:"",code:"",details:{province:{code:"",location:{},name:"",pinyin:""},city:{code:"",location:{},name:"",pinyin:""},district:{code:"",location:{},name:"",pinyin:""}}},a=t=>{const o=JSON.stringify(t);return JSON.parse(o)},s=t=>{const{timeout:o,enableHighAccuracy:e}={...r,...t};return new Promise(((t,n)=>{if(navigator.geolocation){const i=navigator.geolocation.watchPosition((o=>{const{latitude:e,longitude:n}=o.coords;navigator.geolocation.clearWatch(i),t({latitude:e,longitude:n})}),(t=>{switch(navigator.geolocation.clearWatch(i),t.code){case t.PERMISSION_DENIED:n("html5已拒绝定位");break;case t.POSITION_UNAVAILABLE:n("html5位置信息不可用");break;case t.TIMEOUT:n("html5定位超时");break;case t.UNKNOWN_ERROR:n("html5定位未知错误")}}),{enableHighAccuracy:e,timeout:o,maximumAge:0})}else n("浏览器不支持HTML5定位")}))},l=t=>{const{timeout:o}={...r,...t};return Promise.race([new Promise(((t,e)=>{const n=document.getElementsByTagName("head")[0],i=document.createElement("script");n.appendChild(i),i.timer=setTimeout((()=>{window.getIpLocation=null,n.removeChild(i),e("ip定位超时")}),o),i.src=window.location.protocol+"//pv.sohu.com/cityjson?ie=utf-8",i.onload=()=>{if(n.removeChild(i),clearTimeout(i.timer),returnCitySN&&returnCitySN.cid){const o=returnCitySN.cid.slice(0,4)+"00",n=returnCitySN.cid.slice(0,2)+"0000";p("city",n).then((n=>{const i=n.find((t=>t.id===o));i?t(i.location):e("ip定位失败")})).catch((t=>{console.log(t),e("ip定位失败")}))}else e("ip定位失败")}})),(t=>new Promise(((o,e)=>{setTimeout((()=>{e("ip定位超时")}),t)})))(o)])},u=({latitude:t,longitude:o,address:e})=>e.find((e=>e.polygon.find((e=>{if(n([o,t],e))return e})))),p=(t,o)=>{const e=r.url;return new Promise(((n,r)=>{fetch(`${e}/static/${t}/${o}.json`).then((t=>t.json())).then((t=>{const o=i(t.s),e=JSON.parse(o);n(e)})).catch((t=>{console.log("文件获取失败"+t),r(t)}))}))},d=async({latitude:t,longitude:o})=>{try{const e={...a(c),latitude:t,longitude:o},n=await p("province",0),i=u({latitude:t,longitude:o,address:n});if(i){e.province=i.name,e.code=i.id,e.details.province={code:i.id,location:i.location,name:i.name,pinyin:i.pinyin};const n=await p("city",i.id),r=u({latitude:t,longitude:o,address:n});if(r){e.city=r.name,e.code=r.id,e.details.city={code:r.id,location:r.location,name:r.name,pinyin:r.pinyin};const n=await p("district",r.id),i=u({latitude:t,longitude:o,address:n});i&&(e.district=i.name,e.code=i.id,e.details.district={code:i.id,location:i.location,name:i.name,pinyin:i.pinyin})}}if(!e.code)throw new Error("非中国境内");return e}catch(t){throw t}},h=t=>t.map((t=>({code:t.id,name:t.name,pinyin:t.pinyin,location:t.location})));t.exports={getLocation:t=>{const o={...r,...t};return new Promise(((t,e)=>{s(o).then((({latitude:o,longitude:n})=>{d({latitude:o,longitude:n}).then((o=>{t({...o,type:"h5"})})).catch((t=>{e(t)}))})).catch((n=>{console.log(n),l(o).then((({latitude:o,longitude:n})=>{d({latitude:o,longitude:n}).then((o=>{t({...o,type:"ip"})})).catch((t=>{e(t)}))})).catch((t=>{console.log(t),e(t)}))}))}))},getH5Location:s,getIpLocation:l,getAddress:d,searchList:async t=>{try{if(!t){const t=await p("province",0);return h(t)}if("0000"===t.toString().slice(2)){const o=await p("city",t);return h(o)}const o=await p("district",t);return h(o)}catch(t){throw t}},setConfig:({timeout:t,url:o})=>{t&&(r.timeout=t),o&&(r.url=o)}}}},o={},function e(n){var i=o[n];if(void 0!==i)return i.exports;var r=o[n]={exports:{}};return t[n](r,r.exports,e),r.exports}(138);var t,o}));